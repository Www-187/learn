# 1.常见的数据库对象



- | 对象                | 描述                                                         |
  | ------------------- | ------------------------------------------------------------ |
  | 表(TABLE)           | 表是存储数据的逻辑单元，以行和列的形式存在，列就是字段，行就是记录 |
  | 数据字典            | 就是系统表，存放数据库相关信息的表。系统表的数据通常由数据库系统维护，程序员通常不应该修改，只可查看 |
  | 约束(CONSTRAINT)    | 执行数据校验的规则，用于保证数据完整性的规则                 |
  | 视图(VIEW)          | 一个或者多个数据表里的数据的逻辑显示，视图并不存储数据       |
  | 索引(INDEX)         | 用于提高查询性能，相当于书的目录                             |
  | 存储过程(PROCEDURE) | 用于完成一次完整的业务处理，没有返回值，但可通过传出参数将多个值传给调用环境 |
  | 存储函数(FUNCTION)  | 用于完成一次特定的计算，具有一个返回值                       |
  | 触发器(TRIGGER)     | 相当于一个事件监听器，当数据库发生特定事件后，触发器被触发，完成相应的处理 |

------

## 2.视图概述

#### 什么是视图

- 视图理解为一张虚拟的表，但并不是真正表，它不存储数据，而存储的是查询语句
- 视图建立在已有的表上，该表称为基表
- 视图的创建和删除不会影响基表
- 对视图的数据进行增删改时，会影响基表
- 对基表的改动都会影响视图

#### 为什么需要视图

- 视图可以将查询语句存储起来，方便下次查询使用
- 控制数据库的访问权限

------

## 3.视图的使用

#### 创建视图

- ```mysql
  #举例1：同创建表，AS后加丰富的查询语句
  CREATE VIEW view1
  AS
  SELECT last_name,salary
  FROM employees;
  
  SELECT *
  FROM view1;
  ```

- ```mysql
  #举例2：确定视图的字段名1：查询语句的字段的别名，会作为视图的字段名
  CREATE VIEW view2
  AS
  SELECT last_name AS 'name',salary AS 'month_salary'
  FROM employees;
  
  SELECT *
  FROM view2;#此时view2的字段名就是name和month_salary
  ```

- ```mysql
  #举例3：确定视图的字段名2：在视图名后面加字段名，注意字段个数要相同
  CREATE VIEW view3(`name`,month_salary)
  AS
  SELECT last_name,salary
  FROM employees;
  
  SELECT *
  FROM view3;
  ```

- ```mysql
  #举例4：基于视图，创建视图
  CREATE VIEW view4(last_name)
  AS
  SELECT last_name
  FROM view1;
  ```

#### 查看视图

- ```mysql
  #查看数据库中有哪些表，视图
  SHOW TABLES;#能查看表和视图
  ```

- ```mysql
  #查看视图结构:字段，数据类型，约束，
  DESC view2;
  ```

- ```mysql
  #查看视图的属性信息:引擎，视图版本
  SHOW TABLE STATUS LIKE 'view2';
  ```

- ```mysql
  #查看视图创建时的信息
  SHOW CREATE TABLE view2;
  ```

#### 视图的DML

- ```mysql
  SELECT 字段 FROM 表 WHERE 过滤条件;
  
  UPDATE 表 SET 新数据 WHERE 过滤条件;
  #添加时一定要注意视图的字段，否则有时会失败
  #如视图有部门号,平均工资，修改平均工资就失败
  
  DELETE FROM 表 WHERE 过滤条件;
  
  INSERT INTO 表 VALUES 数据;
  ```

#### 视图的DDL

- ```mysql
  #修改视图
  #方式一：
  ALTER VIEW 表  AS
  
  #方式二：
  #没有视图就创建，有视图就替换，替换也是一种修改
  CREATE OR REPLACE VIEW 视图名 AS 查询语句;
  ```

- ```mysql
  #删除视图
  DROP VIEW IF EXISTS view2;
  ```

- ```mysql
  #说明：基于视图a、b创建了新的视图c，如果将视图a或者视图b删除，会导致视图c的查询失败。这样的视图c需要手动删除或修改，否则影响使用。
  ```

#### 视图的优点

- 简化查询，简化操作
  - 将经常使用的查询操作定义为视图，可以使开发人员不需要关心视图对应的数据表的结构、表与表之间的关联关系，也不需要关心数据表之间的业务逻辑和查询条件，而只需要简单地操作视图即可，极大简化了开发人员对数据库的操作
- 控制数据库访问权限
  - MySQL将用户对数据的 访问限制 在某些数据的结果集上，而这些数据的结果集可以使用视图来实现。用户不必直接查询或操作数据表。这也可以理解为视图具有 隔离性 。视图相当于在用户和实际的数据表之间加了一层虚拟表。同时，MySQL可以根据权限将用户对数据的访问限制在某些视图上，用户不需要查询数据表，可以直接通过视图获取数据表中的信息。这在一定程度上保障了数据表中数据的安全性。
-  能够分解复杂的查询逻辑
  - 数据库中如果存在复杂的查询逻辑，则可以将问题进行分解，创建多个视图获取数据，再将创建的多个视图结合起来，完成复杂的查询逻辑
- 适应灵活多变的需求
  - 当业务系统的需求发生变化后，如果需要改动数据表的结构，则工作量相对较大，可以使用视图来减少改动的工作量。这种方式在实际工作中使用得比较多。
- 减少数据冗余
  - 视图跟实际数据表不一样，它存储的是查询语句。所以，在使用的时候，我们要通过定义视图的查询语句来获取结果集。而视图本身不存储数据，不占用数据存储的资源，减少了数据冗余。

#### 视图的缺点

- 如果基表的结构变更了，就需要对相关的视图进行的维护。特别是嵌套的视图，维护会变得比较复杂，增加维护的成本
- 实际项目中，如果视图过多，会导致数据库维护成本的问题
- 大型项目推荐使用视图，小型项目推荐不使用视图

------

